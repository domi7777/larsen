var z=Object.defineProperty;var D=(e,o,t)=>o in e?z(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var P=(e,o,t)=>(D(e,typeof o!="symbol"?o+"":o,t),t);import{r as L,a as M,R as k}from"./react-H14vcryl.js";import{P as T}from"./phaser-pQREW5IE.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var O={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I=L,H=Symbol.for("react.element"),j=Symbol.for("react.fragment"),W=Object.prototype.hasOwnProperty,$=I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,U={key:!0,ref:!0,__self:!0,__source:!0};function v(e,o,t){var i,n={},r=null,s=null;t!==void 0&&(r=""+t),o.key!==void 0&&(r=""+o.key),o.ref!==void 0&&(s=o.ref);for(i in o)W.call(o,i)&&!U.hasOwnProperty(i)&&(n[i]=o[i]);if(e&&e.defaultProps)for(i in o=e.defaultProps,o)n[i]===void 0&&(n[i]=o[i]);return{$$typeof:H,type:e,key:r,ref:s,props:n,_owner:$.current}}F.Fragment=j;F.jsx=v;F.jsxs=v;O.exports=F;var g=O.exports,A={},b=M;A.createRoot=b.createRoot,A.hydrateRoot=b.hydrateRoot;let y=null;const h=()=>{if(!y){const e=window.AudioContext||window.webkitAudioContext;y=new e}return y},K=()=>{y=null};function J(){const e=h(),o=e.sampleRate*.05,t=e.createBuffer(1,o,e.sampleRate),i=t.getChannelData(0);for(let l=0;l<o;l++)i[l]=Math.random()*2-1;const n=e.createBufferSource();n.buffer=t;const r=e.createBiquadFilter();r.type="highpass",r.frequency.setValueAtTime(8e3,e.currentTime),r.Q.setValueAtTime(1,e.currentTime);const s=e.createGain();s.gain.setValueAtTime(1,e.currentTime),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+.05),n.connect(r),r.connect(s),s.connect(e.destination),n.start(),n.stop(e.currentTime+.05);const a=e.createOscillator();a.type="square",a.frequency.setValueAtTime(1e4,e.currentTime);const c=e.createGain();c.gain.setValueAtTime(.1,e.currentTime),c.gain.exponentialRampToValueAtTime(.001,e.currentTime+.03),a.connect(c),c.connect(e.destination),a.start(),a.stop(e.currentTime+.03)}function Q(){const e=h(),o=e.sampleRate*.2,t=e.createBuffer(1,o,e.sampleRate),i=t.getChannelData(0);for(let l=0;l<o;l++)i[l]=Math.random()*2-1;const n=e.createBufferSource();n.buffer=t;const r=e.createBiquadFilter();r.type="highpass",r.frequency.setValueAtTime(1e3,e.currentTime);const s=e.createGain();s.gain.setValueAtTime(1,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.2),n.connect(r),r.connect(s),s.connect(e.destination),n.start(),n.stop(e.currentTime+.2);const a=e.createOscillator();a.type="sine",a.frequency.setValueAtTime(150,e.currentTime);const c=e.createGain();c.gain.setValueAtTime(.7,e.currentTime),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+.1),a.connect(c),c.connect(e.destination),a.start(),a.stop(e.currentTime+.1)}function Y(){const e=h(),o=e.createOscillator();o.type="sine";const t=e.createGain();o.frequency.setValueAtTime(200,e.currentTime),o.frequency.exponentialRampToValueAtTime(70,e.currentTime+.05),t.gain.setValueAtTime(1,e.currentTime),t.gain.exponentialRampToValueAtTime(.001,e.currentTime+1),o.connect(t),t.connect(e.destination),o.start(),o.stop(e.currentTime+1.5)}function Z(){const e=h(),o=e.sampleRate*1.5,t=e.createBuffer(1,o,e.sampleRate),i=t.getChannelData(0);for(let u=0;u<o;u++)i[u]=Math.random()*2-1;const n=e.createBufferSource();n.buffer=t;const r=e.createBiquadFilter();r.type="highpass",r.frequency.setValueAtTime(4e3,e.currentTime);const s=e.createBiquadFilter();s.type="lowpass",s.frequency.setValueAtTime(12e3,e.currentTime);const a=e.createGain();a.gain.setValueAtTime(1,e.currentTime),a.gain.exponentialRampToValueAtTime(.001,e.currentTime+1.5),n.connect(r),r.connect(s),s.connect(a),a.connect(e.destination),n.start(),n.stop(e.currentTime+1.5);const c=e.createOscillator();c.type="triangle",c.frequency.setValueAtTime(1e4,e.currentTime);const l=e.createGain();l.gain.setValueAtTime(.05,e.currentTime),l.gain.exponentialRampToValueAtTime(.001,e.currentTime+1.5),c.connect(l),l.connect(e.destination),c.start(),c.stop(e.currentTime+1.5)}const d=e=>T.Display.Color.HexStringToColor(e).color;function X(){const e=h(),o=e.sampleRate*.5,t=e.createBuffer(1,o,e.sampleRate),i=t.getChannelData(0);for(let c=0;c<o;c++)i[c]=Math.random()*2-1;const n=e.createBufferSource();n.buffer=t;const r=e.createBiquadFilter();r.type="highpass",r.frequency.setValueAtTime(5e3,e.currentTime);const s=e.createBiquadFilter();s.type="lowpass",s.frequency.setValueAtTime(1e4,e.currentTime);const a=e.createGain();a.gain.setValueAtTime(.6,e.currentTime),a.gain.exponentialRampToValueAtTime(.001,e.currentTime+.5),n.connect(r),r.connect(s),s.connect(a),a.connect(e.destination),n.start(),n.stop(e.currentTime+.5)}function ee(){const e=h(),o=e.sampleRate*1.2,t=e.createBuffer(1,o,e.sampleRate),i=t.getChannelData(0);for(let c=0;c<o;c++)i[c]=Math.random()*2-1;const n=e.createBufferSource();n.buffer=t;const r=e.createBiquadFilter();r.type="highpass",r.frequency.setValueAtTime(3e3,e.currentTime);const s=e.createBiquadFilter();s.type="lowpass",s.frequency.setValueAtTime(9e3,e.currentTime);const a=e.createGain();a.gain.setValueAtTime(.8,e.currentTime),a.gain.exponentialRampToValueAtTime(.001,e.currentTime+1.2),n.connect(r),r.connect(s),s.connect(a),a.connect(e.destination),n.start(),n.stop(e.currentTime+1.2)}function _(e=99,o=500){const t=h(),i=t.createOscillator();i.type="sine",i.frequency.setValueAtTime(e,t.currentTime);const n=t.createGain();n.gain.setValueAtTime(1,t.currentTime),n.gain.exponentialRampToValueAtTime(.001,t.currentTime+.5),i.detune.setValueAtTime(-5,t.currentTime),i.connect(n),n.connect(t.destination),i.start(),i.stop(t.currentTime+o/1e3)}function te(){_(120,400)}const p={Material:"Material",Arial:"Arial"},oe=async()=>{const e=new FontFace(p.Material,"url(./fonts/material.woff2)");return document.fonts.add(e),e.load().catch(o=>console.error(o))};let R=!1,S=0,m=[],f=0,C=null;function ne(){R=!0,S=Date.now(),m=[],console.log("Recording started")}function w(){R=!1,m.push({instrument:null,time:Date.now()-S}),console.log("Recording stopped")}function re(){const e=()=>{f>=m.length&&(f=0);const{instrument:o,time:t}=m[f],i=f===0?0:m[f-1].time;C=setTimeout(()=>{console.log(`Playing ${o} after ${t}ms`),o&&G(o),f++,e()},t-i)};console.log("Loop play starting"),e()}function V(){C&&clearTimeout(C),console.log("Loop stopped")}const B={hihat:J,kick:Y,snare:Q,crash:Z,"hihat-open":X,ride:ee,"tom-low":_,"tom-high":te},G=e=>{console.log(`Playing ${e}`);try{B[e]()}catch(o){console.error(`Error playing ${e}`,o),K(),B[e]()}if(R){const o=Date.now()-S;m.push({instrument:e,time:o}),console.log(`Recording ${e} at time ${o}ms`)}},ie={hihat:"#FDA341",kick:"#F24E1E",snare:"#4A90E2",crash:"#A0D8C5","hihat-open":"#F9F871",ride:"#F5C542","tom-low":"#FF7F50","tom-high":"#9B59B6"},q={idle:"#FFF",readyToRecord:"#0FF",recording:"#FD0041",playing:"#0F0"};class se extends T.Scene{constructor(){super(...arguments);P(this,"controls")}create(){this.createPads(),this.createControlButtons()}createPads(){const t=[this.createPad("crash"),this.createPad("ride"),this.createPad("hihat-open"),this.createPad("hihat"),this.createPad("snare"),this.createPad("tom-low"),this.createPad("tom-high"),this.createPad("kick")],i=()=>{const s=window.innerWidth/4,a=window.innerHeight/2;t.forEach(({button:c},l)=>{const u=l%4*s,x=Math.floor(l/4)*a;c.setSize(s,a).setPosition(u,x)})};window.addEventListener("resize",i),i()}createPad(t){const i=this.add.rectangle().setFillStyle(d(ie[t])).setStrokeStyle(2,d("#FFF"),.8).setInteractive().setOrigin(0,0);return i.on("pointerdown",()=>{i.setAlpha(.7),this.controls.state==="readyToRecord"&&(this.controls.state="recording",this.updateControlsText(),ne()),G(t)}).on("pointerup",()=>i.setAlpha(1)).on("pointerout",()=>i.setAlpha(1)),{instrument:t,button:i}}createControlButton(){const t=this.add.rectangle().setFillStyle(d("#000")).setStrokeStyle(2,d("#FFF"),.8).setOrigin(0,0);return t.setInteractive().on("pointerdown",()=>t.setFillStyle(d("#666"))).on("pointerup",()=>t.setFillStyle(d("#000"))).on("pointerout",()=>t.setFillStyle(d("#000"))),t}createText(t){return this.add.text(0,0,t,{fontFamily:p.Material,fontSize:20,color:"#FFF",align:"center",resolution:2}).setOrigin(.5,.5).setData("initial",t)}createControlButtons(){this.controls={state:"idle",stop:{button:this.createControlButton(),text:this.createText("stop")},record:{button:this.createControlButton(),text:this.createText("fiber_manual_record")},play:{button:this.createControlButton(),text:this.createText("play_arrow")}};const{record:t,stop:i,play:n}=this.controls;t.button.setInteractive().on("pointerdown",()=>{this.controls.state==="idle"||this.controls.state==="playing"?(V(),this.controls.state="readyToRecord"):this.controls.state==="readyToRecord"?this.controls.state="idle":this.controls.state==="recording"&&(this.controls.state="idle",w()),this.updateControlsText()}),i.button.setInteractive().on("pointerdown",()=>{this.controls.state==="recording"&&w(),this.controls.state==="playing"&&V(),this.controls.state="idle",this.updateControlsText()}),n.button.setInteractive().on("pointerdown",()=>{this.controls.state==="recording"&&w(),m.length>0?(this.controls.state="playing",re(),this.updateControlsText()):(this.controls.state="idle",this.updateControlsText(),console.log("No loop to play"),this.controls.play.text.setFontFamily(p.Arial).setText("No loop to play, record first"),this.time.delayedCall(2e3,()=>{this.updateControlsText()}))});const r=()=>{const s=window.innerWidth,a=window.innerHeight,c=Math.max(a,s)/15,l=s/3;[i,t,n].forEach(({button:u,text:x},N)=>{u.setSize(l,c).setPosition(l*N,-1),x.setFontSize(c/2).setWordWrapWidth(u.width,!0).setSize(u.width,u.height).setPosition(u.getCenter().x,u.getCenter().y)})};window.addEventListener("resize",r),r()}updateControlsText(){const{record:{text:t},stop:{text:i},play:{text:n}}=this.controls;[t,i,n].forEach(s=>s.setFontFamily(p.Material).setText(s.getData("initial")).setColor(q.idle));const r=q[this.controls.state];switch(this.controls.state){case"idle":break;case"readyToRecord":t.setFontFamily(p.Arial).setText("Hit a pad to start").setColor(r);break;case"recording":t.setFontFamily(p.Material).setColor(r);break;case"playing":n.setFontFamily(p.Material).setColor(r);break}}}function ae(e){const o=window.innerWidth,t=window.innerHeight;e.scale.resize(o,t),e.scene.scenes.forEach(i=>{var n,r;return(r=(n=i.sys)==null?void 0:n.scale)==null?void 0:r.refresh()})}let E=!1;const ce=()=>(E||(E=!0,oe().then(()=>{const e=new T.Game({type:T.AUTO,mode:T.Scale.RESIZE,parent:"phaser-container",width:window.innerWidth,height:window.innerHeight,backgroundColor:"#FFF",scene:[se],input:{activePointers:4}});window.addEventListener("resize",()=>{ae(e)})})),g.jsx(g.Fragment,{}));function le(){return g.jsx(ce,{})}A.createRoot(document.getElementById("root")).render(g.jsx(k.StrictMode,{children:g.jsx(le,{})}));
